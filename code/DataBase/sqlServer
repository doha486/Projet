-- Création de la base de données
CREATE DATABASE dbProjet;
GO

-- Utilisation de la base de données
USE dbProjet ;
GO

-- Création de la table Manager
CREATE TABLE Manager (
    IdManager INT IDENTITY(1,1) PRIMARY KEY,
    NomManager VARCHAR(255)   NOT NULL,
    EmailManager VARCHAR(255)   NOT NULL, 
    MdpManager VARCHAR(255)   NOT NULL,
    DepartementManager VARCHAR(255)   NOT NULL,
    Equipe VARCHAR(255)   NOT NULL,
);
GO

-- Création de la table Equipe
CREATE TABLE Equipe (
    IdEquipe INT IDENTITY(1,1) PRIMARY KEY,
    NomEquipe VARCHAR(255)  NOT NULL,
    descriptionEquipe NVARCHAR(MAX) NOT NULL,
    Nombre membre INT   NOT NULL,
    DateCreationEquipe DATE   NOT NULL,
    IdManager INT   NOT NULL,
    FOREIGN KEY (IdManager) REFERENCES Manager(IdManager)
);
GO

-- Création de la table Projet
CREATE TABLE Projet (
    IdProjet INT IDENTITY(1,1) PRIMARY KEY,
    NomProjet VARCHAR(255)  NOT NULL,
    DescriptionProjet NVARCHAR(MAX)  NOT NULL,
    Date_debut DATE  NOT NULL,
    Date_fin DATE  NOT NULL,
    StatutProjet VARCHAR(255)  NOT NULL,
    IdEquipe INT  NOT NULL,
    FOREIGN KEY (IdEquipe) REFERENCES Equipe(IdEquipe)
);
GO



CREATE TABLE Recruteur (
    IdRecruteur INT IDENTITY(1,1) PRIMARY KEY,
    NomRecruteur NVARCHAR(255) NOT NULL,
    DépartementRecruteur NVARCHAR(255) NOT NULL,
    Poste NVARCHAR(255) NOT NULL,
	EmailRecruteur NVARCHAR (255) NOT NULL,
	MdpRecruteur NVARCHAR (255) NOT NULL
);
GO
CREATE TABLE Offre (
    IdOffre INT IDENTITY(1,1) PRIMARY KEY,
    Titre NVARCHAR(255) NOT NULL,
    DescriptionOffre NVARCHAR(MAX) NOT NULL,
    DatePublication DATE NOT NULL,
    IdRecruteur INT,
    FOREIGN KEY (IdRecruteur) REFERENCES Recruteur(IdRecruteur)
);
GO
CREATE TABLE Candidat (
    IdCandidat INT IDENTITY(1,1) PRIMARY KEY,
    NomCandidat VARCHAR(255) NOT NULL,
    EmailCandidat NVARCHAR(255) UNIQUE NOT NULL,
    MdpCandidat NVARCHAR(255) NOT NULL,
    Telephone VARCHAR(10) NOT NULL,
    Profil NVARCHAR(MAX),
    CV NVARCHAR(MAX),
    Adresse NVARCHAR(MAX)
);
GO
CREATE TABLE Offre_Candidat (
    IdOffre  INT  NOT NULL,
    IdCandidat INT NOT NULL,
    PRIMARY KEY (IdOffre, IdCandidat),
    FOREIGN KEY (IdOffre) REFERENCES Offre(IdOffre),
    FOREIGN KEY (IdCandidat) REFERENCES Candidat(IdCandidat)
);
GO
CREATE TABLE Candidature (
    IdCandidature INT IDENTITY(1,1) PRIMARY KEY,
    StatutCandidature NVARCHAR(50) NOT NULL,
    DateSoumission DATE NOT NULL,
    IdCandidat INT,
	IdOffre INT,
    FOREIGN KEY (IdCandidat) REFERENCES Candidat(IdCandidat),
	FOREIGN KEY (Idoffre) REFERENCES Offre(IdOffre)
);GO
CREATE TABLE Entretien (
    IdEntretien INT IDENTITY(1,1) PRIMARY KEY,
    Date DATE NOT NULL,
    Heure TIME NOT NULL,
    Lieu NVARCHAR(255) NOT NULL,
    IdCandidature INT,
	IdRecruteur INT,
    FOREIGN KEY (IdCandidature) REFERENCES Candidature(IdCandidature),
	FOREIGN KEY (IdRecruteur) REFERENCES Recruteur(IdRecruteur)
);GO
-- Création de la table Admin
CREATE TABLE Admin (
    IdAdmin INT IDENTITY(1,1) PRIMARY KEY,
    NomAdmin VARCHAR(255) NOT NULL,
    EmailAdmin VARCHAR(255) UNIQUE NOT NULL,
    MdpAdmin VARCHAR(255) NOT NULL,
    Rôle VARCHAR(100) NOT NULL
);
GO

-- Création de la table Compte
CREATE TABLE Compte (
    IdCompte INT IDENTITY(1,1) PRIMARY KEY,
    NomUtilisateur VARCHAR(255) NOT NULL,
    EmailCompte VARCHAR(255) UNIQUE NOT NULL,
    MdpCompte VARCHAR(255) NOT NULL,
    DateCreationCpmpte DATE NOT NULL,
    StatutCompte VARCHAR(100) NOT NULL,
    IdAdmin INT,
    FOREIGN KEY (IdAdmin) REFERENCES Admin(IdAdmin) ON DELETE SET NULL
);

GO









-- Insertion des managers
INSERT INTO Manager (IdManager, NomManager, EmailManager, MdpManager, Departement, Equipe) 
VALUES 
(1, 'AA', 'AA.PP@example.com', 'mdp123', 'Informatique', 'Développement'),
(2, 'OO', 'OO.LL@example.com', 'mdp456', 'Marketing', 'Communication');
GO

-- Insertion des équipes
INSERT INTO Equipe (IdEquipe, NomEquipe, description_, Nombre_Membre, Date_Creation, IdManager) 
VALUES 
(1, 'Développement Web', 'Équipe responsable du développement des applications web.', 5, '2023-05-10', 1),
(2, 'Communication Digitale', 'Équipe en charge de la stratégie digitale.', 3, '2024-01-15', 2);
GO

-- Insertion des projets
INSERT INTO Projet (IdProjet, NomProjet, Description_, Date_Debut, Date_Fin, Statut, IdEquipe) 
VALUES 
(1, 'Site e-commerce', 'Développement d’une plateforme e-commerce.', '2024-02-01', '2024-06-01', 'En cours', 1),
(2, 'Campagne SEO', 'Optimisation du référencement naturel.', '2024-03-01', '2024-05-01', 'Planifié', 2);
GO
-- Insertion des données dans Admin
INSERT INTO Admin (NomAdmin, EmailAdmin, MdpAdmin, Rôle) 
VALUES 
('Alice Dupont', 'alice.dupont@example.com', 'pass123', 'Super Admin'),
('Jean Martin', 'jean.martin@example.com', 'admin456', 'Gestionnaire');
GO

-- Insertion des données dans Compte
INSERT INTO Compte (NomUtilisateur, Email, MdpCompte, DateCreation, Statut, IdAdmin) 
VALUES 
('Utilisateur1', 'user1@example.com', 'userpass1', '2025-03-01', 'Actif', 1),
('Utilisateur2', 'user2@example.com', 'userpass2', '2025-03-05', 'Inactif', 1),
('Utilisateur3', 'user3@example.com', 'userpass3', '2025-03-10', 'Actif', 2);
GO


-- Insérer des recruteurs
INSERT INTO Recruteur (NomRecruteur, Département, Poste) 
VALUES 
('Alice Dupont', 'Ressources Humaines', 'Responsable RH'),
('Jean Martin', 'Informatique', 'Chef de projet'),
('Sophie Bernard', 'Marketing', 'Manager Communication');
GO

-- Insérer des offres
INSERT INTO Offre (Titre, Description, DatePublication, IdRecruteur) 
VALUES 
('Développeur Web', 'Nous recherchons un développeur web expérimenté.', '2025-03-01', 2),
('Graphiste', 'Création de visuels pour nos campagnes marketing.', '2025-03-05', 3),
('Consultant RH', 'Accompagnement dans le recrutement et la gestion des talents.', '2025-03-10', 1);
GO

-- Insérer des candidats
INSERT INTO Candidat (NomCandidat, EmailCandidat, MdpCandidat, Telephone, Profil, CV, Adresse) 
VALUES 
('Pierre Durand', 'pierre.durand@example.com', 'mdp123', 654321897, 'Développeur Full Stack', 'CV_Pierre.pdf', '12 rue des Lilas, Paris'),
('Laura Morel', 'laura.morel@example.com', 'mdp456', 612345678, 'Graphiste UX/UI', 'CV_Laura.pdf', '45 avenue de Lyon, Lyon'),
('Mohamed Ali', 'mohamed.ali@example.com', 'mdp789', 678901234, 'Consultant RH', 'CV_Mohamed.pdf', '78 boulevard Haussmann, Paris');
GO


-- Associer des candidats à des offres
INSERT INTO Offre_Candidat (IdOffre, IdCandidat) 
VALUES 
(1, 1), -- Pierre postule pour Développeur Web
(2, 2), -- Laura postule pour Graphiste
(3, 3); -- Mohamed postule pour Consultant RH
GO

-- Insérer des candidatures
INSERT INTO Candidature (Statut, DateSoumission, IdCandidat) 
VALUES 
('En attente', '2025-03-02', 1),
('Acceptée', '2025-03-06', 2),
('Refusée', '2025-03-11', 3);
GO

-- Insérer des entretiens
INSERT INTO Entretien (Date, Heure, Lieu, IdCandidature) 
VALUES 
('2025-03-05', '10:00:00', 'Siège social - Salle A', 1),
('2025-03-08', '14:30:00', 'Agence de Lyon', 2);
GO

-- Vérification des données insérées
SELECT * FROM Recruteur;
SELECT * FROM Offre;
SELECT * FROM Candidat;
SELECT * FROM Offre_Candidat;
SELECT * FROM Candidature;
SELECT * FROM Entretien;
SELECT * FROM Admin;
SELECT * FROM Compte;
SELECT * FROM Manager;
SELECT * FROM Equipe;
SELECT * FROM Projet;

